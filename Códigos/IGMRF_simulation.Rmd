---
title: "IGMRF"
author: "Cristiana"
date: "01/09/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Simulating with a fixed value for tau
library(phylodyn)
library(ggplot2)
library(latex2exp)
library(Matrix)

tau <- 100

trajectory = exp_traj
n = 30
samp_times = rep(1,n)

stimes20 <- sort(runif(n), 0, 10)

#Simulating a genealogy based on the sample
gene = coalsim(samp_times = stimes, 
               n_sampled = samp_times,
               traj = trajectory, 
               lower_bound = 1)

samp_times = stimes20,
                    n_sampled = rep(1,20),
                    traj = const10,
                    lower_bound = 1)
k <- n - 1

midpoint_distance <- (gene$intercoal_times[1:k-1] + gene$intercoal_times[2:k])/2

```

